[[{"l":"-_-","p":["welcome ty my sites retype-hero"]}],[{"i":"caprадрессация","l":"Capr+адрессация","p":["заходим сразу на cl-r3/cl-r2 делаем адрессацию lan для cl-r3- 10.3 lan для cl2-r2-10.2 далее идем на mg-pc (ip10.11/шлюз 10.1) заходив в Opnsense открывает 10.2 и 10.3 10.2= inteerfaces - virtul ips - + mode capr interface lan ip 10.1 peer 10.3 password P@sswor group 2 adb 1 описание lan","Делаем еще один","nteerfaces - virtul ips - + mode capr interface wan ip 100.99.90.100/27 peer 10.3 password P@sswor group 1 adb 1","ДРУГАЯ ТАЧКА 10.3= inteerfaces - virtul ips - + mode capr interface lan ip 10.1 peer 10.2 password P@sswor group 2 adb 1 описание lan","nteerfaces - virtul ips - + mode capr interface wan ip 100.99.90.100/28 peer 10.2 password P@sswor group 1 adb 1"]}],[{"l":"Captive","p":["Captive portal","Заходим в captive portal и создаем zone","Выбераем интерфейс тот который смотрит в сторону той машины где мы будет работать captive portal В Allow inbound выбераем сети к которым будем иметь доступ ( локальные ) В Authenticate using выбераем Local Database ( это локальная база откуда мы будем брать логин и пароль ) В конце можно по желанию добавить описание для этой зоны Сохраням и выходим","Заходим в System > Access > Users и там добавляем пользователя под которым мы будем авторизироваться Нажимаем + для создания х Указываем username ( Пример: guest ) пароль ( P@ssw0rd) ( другие настройки я не менял ) Делаем правила для работы captive portal Заходим в Firewall > Rules > OPT2+","Нажимаем на + и создаем правила Первое правило (разрешаем выход в интернет ) не забываем убрать галочку Quick ( она нужна чтобы правило работало после других и не давало сразу доступ )","Второе и третье правило (запрещаем доступ к локальной сети)","Тут я запретил доступ к сети где у меня pc-rnd","Тут я запретил доступ к сети где у меня dc-rnd ( обязательно надо убрать галочку Quick ) Четвертое правило ( разрешаем заходить в логин captive portal )","Пятое и шестое правило ( даем доступ к локальным ресурсам нужные для выполнения задания )","И по такому же принципу создаем правило с разрешение 53 порта для DNS","* информацию я брал и переделал немного оттуда: https://www.zenarmor.com/docs/network-security-tutorials/how-to-configure-captive-portal-on-opnsense"]}],[{"l":"Docker","p":["sudo dnf install git cd /opt sudo git clone http://github.com/zammad/zammad-docker-compose sudo mv zammad-docker-compose/*. mkdir -p zammad nano /etc/docker-compose.yml//идем в конец файла и ищем - volumes: image","делаем так же как на скрине sudo dnf install docker-ce docker-ce-cli docker-compose systemctl start docker sudo docker compose up -d systemctl enable docker"]}],[{"l":"Keeplived","p":["dnf install keeplived nano /etc/keeplived/keeplived.conf"]}],[{"l":"Vlans","p":["Assign Interface","Do you want to configure Vlans now? yes","Дальше надо выбрать интерфейс который смотрит в сторону клиентов у меня vtnet1","Дальше надо добавить тег, смотрим в топологию и вводим 2000","опять выбираем vtnet1 и вводим уже следующий тег 2010","по той же схеме делаем и последний интерфейс","тыкаем enter","дальше мы должны выбрать интерфейс в сторону интернета wan","дальше указываем lan интерфейс у меня это vtnet1_vlan2010","по такому же принципу вводим остальные интерфейсы","когда все сделали нажимаем enter и y"]}],[{"l":"Zabbix","p":["_ date.timezone = Europe/Moscow #обязательно укажите свой часовой пояс","_ listen_addresses = '*'","}","/usr/bin/postgresql-13-setup initdb","\\l","\\q","#Allow replication connections from localhost, by a user with the#replication privilege. local replication all peer","#IPv4 local connections: host all all 127.0.0.1/32 md5","#IPv6 local connections: host all all ::1/128 md5","CREATE DATABASE zabbix WITH OWNER zabbix;","CREATE ROLE zabbix WITH NOSUPERUSER LOGIN PASSWORD 'zabbixpassword';","DBHost=localhost","DBName=zabbix","DBPassword=zabbixpassword","DBUser=zabbix","dnf install httpd zabbix-apache-conf zabbix-sql-scripts","dnf install zabbix-server-pgsql zabbix-web-pgsql zabbix-agent","exit","GRANT ALL PRIVILEGES ON DATABASE zabbix TO zabbix;","host replication all ::1/128 md5","host replication all 127.0.0.1/32 md5","host zabbix zabbix 127.0.0.1/32 password","Listen 80;","local all all peer","Location / {","max_execution_time = 300","max_input_time = 300_","nano /etc/nginx/nginx.conf","nano /etc/php.ini","nano /etc/zabbix/zabbix_server.conf","nano /var/lib/pgsql/13/data/pg_hba.conf","nano /var/lib/pgsql/13/data/postgresql.conf","Nginx","passwd postgres","port = 5432_","post_max_size = 16M","Proxy_pass http://127.0.0.1:82","Proxy_set_header Host $host;","Proxy_set_header X-Forwarded-For $reemote_addr;","Proxy_set_header X-Forwarded-Port $server_port; }","Proxy_set_header X-Real-IP $remote_addr;","psql","Server {","Server_name mon.jun.profi;","su postgres","systemctl enable httpddnf install postgresql13 postgresql13-server","systemctl enable postgresql-13","systemctl enable zabbix-agent","systemctl enable zabbix-server","systemctl restart httpd","systemctl restart postgresql-13","systemctl restart zabbix-agent","systemctl restart zabbix-server","systemctl start postgresql-13","zcat /usr/share/zabbix-sql-scripts/postgresql/server.sql.gz | sudo -u zabbix psql zabbix","Перед конфигом надо будет поменять порт в nano /etc/httpd/httpd.conf на 82"]}]]